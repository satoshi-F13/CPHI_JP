---
title: "CPHI Japan Exhibition Analysis Dashboard"
subtitle: "Comprehensive Analysis of Asia's Leading Pharmaceutical Event (2023-2025)"
date: today
format:
  dashboard:
    theme: 
      light: 
        - default
        - custom.scss
    fillPage: true
    logo: logos/wide/satom-wide-color.png
    nav-buttons:
      - icon: globe
        href: https://www.cphi.com/japan/en/home.html
    fig-width: 10
    fig-height: 6
    embed-resources: true
editor: visual
execute:
  warning: false
  message: false
  echo: false
---
```{r setup, include=FALSE}
# Source all helper files
source("R/setup.R")
source("R/theme.R")
source("R/plot_functions.R")
source("R/data_processing.R")

# Set default theme
theme_set(theme_satom())

# Load all data
data_list <- load_cphi_data()
list2env(data_list, envir = .GlobalEnv)

# Calculate metrics
growth_exhibitors <- calculate_growth_metrics(793, 720)
growth_visitors <- calculate_growth_metrics(34128, 21159)
```

# Overview {.sidebar}

::: card
### About

This dashboard provides comprehensive analysis of **CPHI Japan**, Asia's premier pharmaceutical exhibition.

**Coverage:** 2023-2025\
**Last Updated:** `r Sys.Date()`\
**Source:** Official CPHI Japan Reports

------------------------------------------------------------------------

### Key Highlights

ðŸ“Š **`r format(793, big.mark=",")`** Exhibitors (2025)\
ðŸ‘¥ **`r format(34128, big.mark=",")`** Visitors (2025)\
ðŸŒ **32** Countries Represented\
ðŸ“ˆ **+61.3%** Visitor Growth

------------------------------------------------------------------------

*Powered by* [**SATOM OÃœ**](https://satom.eu/)
:::

# Trends

## Row {height="25%"}

###  {.value-box .primary-box}

<i class="bi bi-building"></i> **Exhibitors 2025**

`r format(793, big.mark=",")`

::: text-muted
+10.1% from 2024
:::

###  {.value-box .secondary-box}

<i class="bi bi-people"></i> **Visitors 2025**

`r format(34128, big.mark=",")`

::: text-muted
+61.3% from 2024
:::

###  {.value-box .tertiary-box}

<i class="bi bi-globe"></i> **Countries**

32

::: text-muted
Participating nations
:::

###  {.value-box .quaternary-box}

<i class="bi bi-graph-up-arrow"></i> **Growth Rate**

+61.3%

::: text-muted
Visitor increase YoY
:::

## Row {height="75%"}

### Column {width="50%"}
```{r exhibitor-trends}
#| title: "Exhibitor Growth Trajectory"
plot_trend_line(
  cphi_main,
  year,
  exhibitors,
  brand_colors["primary"],
  y_label = "Number of Exhibitors"
)
```

### Column {width="50%"}
```{r visitor-trends}
#| title: "Visitor Growth Trajectory"
cphi_main %>%
  filter(!is.na(unique_visitors)) %>%
  plot_trend_line(
    year,
    unique_visitors,
    brand_colors["danger"],
    y_label = "Number of Unique Visitors"
  )
```

# Geography

## Row {height="50%"}

### Column {width="50%"}
```{r exhibitor-geo-2025}
#| title: "Top 10 Exhibitor Countries (2025)"
plot_country_bars(exhibitor_countries_2025, top_n = 10, max_value = 350)
```

### Column {width="50%"}
```{r regional-treemap}
#| title: "Regional Distribution (2025)"
plot_regional_treemap(exhibitor_countries_2025)
```

## Row {height="50%"}

### Column {width="50%"}
```{r visitor-geo-2024}
#| title: "Top 15 Visitor Origin Countries (2024)"
visitor_countries_2024 %>%
  arrange(rank) %>%
  select(Rank = rank, Country = country, Region = region) %>%
  create_styled_table(highlight_top = 5)
```

### Column {width="50%"}
```{r exhibitor-geo-2024}
#| title: "Top 15 Exhibitor Countries (2024)"
exhibitor_countries_2024 %>%
  arrange(rank) %>%
  select(Rank = rank, Country = country, Region = region) %>%
  create_styled_table(highlight_top = 5)
```

# Visitors

## Row {height="25%"}

###  {.value-box .primary-box}

<i class="bi bi-wallet2"></i> **Purchasing Power**

62%

::: text-muted
Visitors with authority
:::

###  {.value-box .secondary-box}

<i class="bi bi-emoji-smile"></i> **Satisfaction**

73%

::: text-muted
Positive experience
:::

###  {.value-box .tertiary-box}

<i class="bi bi-arrow-repeat"></i> **Return Intent**

78%

::: text-muted
Will attend again
:::

###  {.value-box .quaternary-box}

<i class="bi bi-star"></i> **NPS Score**

+35

::: text-muted
Net Promoter Score
:::

## Row {height="75%"}

### Column {width="50%"}
```{r visitor-job-positions}
#| title: "Visitor Job Positions (2024)"
job_positions <- visitor_demo_2024 %>%
  filter(category == "Job Position") %>%
  arrange(desc(percentage)) %>%
  mutate(subcategory = fct_reorder(subcategory, percentage))

p5 <- ggplot(job_positions, aes(x = percentage, y = subcategory)) +
  geom_col(fill = brand_colors["primary"]) +
  geom_text(
    aes(label = paste0(percentage, "%")),
    hjust = -0.2,
    size = 3.5,
    color = brand_colors["navy"]
  ) +
  labs(
    x = "Percentage (%)",
    y = NULL
  ) +
  scale_x_continuous(limits = c(0, 26)) +
  theme_satom()

ggplotly(p5, tooltip = c("y", "x")) %>%
  layout(font = list(family = "Noto Sans"))
```

### Column {width="50%"}
```{r visitor-interests}
#| title: "Primary Areas of Interest (2024)"
interests <- visitor_demo_2024 %>%
  filter(category == "Primary Interest") %>%
  arrange(desc(percentage)) %>%
  mutate(subcategory = fct_reorder(subcategory, percentage))

ggplot(interests, aes(x = percentage, y = subcategory, fill = subcategory)) +
  geom_col(show.legend = FALSE) +
  geom_text(
    aes(label = paste0(percentage, "%")),
    hjust = -0.2,
    size = 4,
    color = brand_colors["navy"]
  ) +
  scale_fill_manual(values = colorRampPalette(cphi_colors)(6)) +
  labs(
    x = "Percentage (%)",
    y = NULL
  ) +
  scale_x_continuous(limits = c(0, 42)) +
  theme_satom()
```

# Exhibitors

## Row {height="30%"}

###  {.value-box .primary-box}

<i class="bi bi-emoji-smile"></i> **Satisfaction**

81%

::: text-muted
Positive experience
:::

###  {.value-box .secondary-box}

<i class="bi bi-arrow-repeat"></i> **Return Intent**

84%

::: text-muted
Will exhibit again
:::

###  {.value-box .tertiary-box}

<i class="bi bi-globe-americas"></i> **International**

61%

::: text-muted
Foreign exhibitors
:::

###  {.value-box .quaternary-box}

<i class="bi bi-star"></i> **NPS Score**

+25

::: text-muted
Net Promoter Score
:::

## Row {height="70%"}

### Column {width="50%"}
```{r exhibitor-objectives}
#| title: "Key Exhibitor Objectives (2024)"
objectives <- exhibitor_data_2024 %>%
  filter(grepl("Objective", category)) %>%
  arrange(desc(percentage)) %>%
  mutate(subcategory = fct_reorder(subcategory, percentage))

ggplot(objectives, aes(x = percentage, y = subcategory)) +
  geom_col(fill = brand_colors["danger"]) +
  geom_text(
    aes(label = paste0(percentage, "%")),
    hjust = -0.2,
    size = 4,
    color = brand_colors["navy"]
  ) +
  labs(
    x = "Percentage (%)",
    y = NULL
  ) +
  scale_x_continuous(limits = c(0, 70)) +
  theme_satom()
```

### Column {width="50%"}
```{r exhibitor-origin}
#| title: "Exhibitor Origin Distribution (2024)"
exhibitor_origin <- exhibitor_data_2024 %>%
  filter(category == "Exhibitor Origin") %>%
  mutate(label = paste0(subcategory, "\n", value, " (", percentage, "%)"))

plot_ly(
  exhibitor_origin,
  labels = ~subcategory,
  values = ~value,
  type = 'pie',
  textinfo = 'label+percent',
  textfont = list(family = "Noto Sans", size = 14),
  marker = list(
    colors = c(brand_colors["primary"], brand_colors["warning"]),
    line = list(color = 'white', width = 2)
  )
) %>%
  layout(
    font = list(family = "Noto Sans"),
    showlegend = TRUE,
    legend = list(font = list(family = "Noto Sans"))
  )
```

# Data Tables

## Row

### Column {.tabset}

#### 2025 Exhibitor Countries
```{r table-2025-countries}
exhibitor_countries_2025 %>%
  arrange(desc(exhibitors)) %>%
  datatable(
    colnames = c("Country", "Exhibitors", "Region"),
    caption = "Complete Exhibitor List by Country (2025)",
    options = list(
      pageLength = 15,
      order = list(list(1, 'desc')),
      dom = 'frtip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#7093BF', 'color': '#fff'});",
        "}"
      )
    ),
    rownames = FALSE,
    class = 'cell-border stripe'
  ) %>%
  formatStyle(
    'exhibitors',
    background = styleColorBar(
      exhibitor_countries_2025$exhibitors,
      brand_colors["primary"]
    ),
    backgroundSize = '98% 88%',
    backgroundRepeat = 'no-repeat',
    backgroundPosition = 'center'
  )
```

#### 2024 Visitor Demographics
```{r table-visitor-demo}
visitor_demo_2024 %>%
  filter(
    category %in% c("Job Position", "Primary Purpose", "Primary Interest")
  ) %>%
  select(category, subcategory, percentage) %>%
  datatable(
    colnames = c("Category", "Item", "Percentage (%)"),
    caption = "Visitor Demographics and Interests (2024)",
    options = list(
      pageLength = 15,
      dom = 'frtip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#7093BF', 'color': '#fff'});",
        "}"
      )
    ),
    rownames = FALSE,
    class = 'cell-border stripe'
  ) %>%
  formatStyle(
    'percentage',
    background = styleColorBar(
      c(0, max(visitor_demo_2024$percentage)),
      brand_colors["success"]
    ),
    backgroundSize = '98% 88%',
    backgroundRepeat = 'no-repeat',
    backgroundPosition = 'center'
  )
```

#### Business Categories
```{r table-business-categories}
business_categories_2024 %>%
  arrange(desc(percentage)) %>%
  datatable(
    colnames = c("Business Category", "Percentage (%)"),
    caption = "Visitor Business Categories (2024)",
    options = list(
      pageLength = 15,
      dom = 'frtip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#7093BF', 'color': '#fff'});",
        "}"
      )
    ),
    rownames = FALSE,
    class = 'cell-border stripe'
  ) %>%
  formatStyle(
    'percentage',
    background = styleColorBar(
      business_categories_2024$percentage,
      brand_colors["warning"]
    ),
    backgroundSize = '98% 88%',
    backgroundRepeat = 'no-repeat',
    backgroundPosition = 'center'
  )
```

#### National Pavilions
```{r table-pavilions}
pavilions %>%
  select(year, pavilion_name, organizing_body) %>%
  arrange(desc(year), pavilion_name) %>%
  datatable(
    colnames = c("Year", "Pavilion Name", "Organizing Body"),
    caption = "National and Industry Pavilions (2024-2025)",
    options = list(
      pageLength = 10,
      dom = 'frtip',
      order = list(list(0, 'desc')),
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#7093BF', 'color': '#fff'});",
        "}"
      )
    ),
    rownames = FALSE,
    class = 'cell-border stripe'
  )
```

# About {orientation="columns"}

## Column {width="60%"}

::: card
### **CPHI Japan**

-   **CPHI Japan Post Show Report 2024** (Primary source)
-   **CPHI Japan Official Website** ([Japanese](https://www.cphijapan.com) \| [English](https://www.cphi.com/japan))
-   **Informa Markets Publications**

------------------------------------------------------------------------

### **Next Event: CPHI Japan 2026**

**Dates:** April 21-23, 2026\
**Venue:** Tokyo Big Sight, East Halls 1-3\
**Expected:** 800+ exhibitors, 35,000+ visitors

------------------------------------------------------------------------

:::

## Column {width="50%"}
```{r tokyo-map}
#| title: "Exhibition Venue Location"
create_venue_map(
  lat = 35.6298,
  lng = 139.7946,
  name = "Tokyo Big Sight",
  zoom = 15
)
```

*For questions or data requests, contact the event organizers.*